# Event to Email Template Mappings
# Configure which Valkey stream events trigger which email templates

notifications:
  event-mappings:

    # Purchase Order Created Event APERTO
    - stream: "purchase-orders-stream"
      event-type: events:new_purchase_order        
      template-code: "CREAZIONE_PO"               
      consumer-group: "notifier-group"  
      auto-ack: true

    # Purchase Order Created Event DA APPROVARE
    - stream: "purchase-orders-stream"
      event-type: events:new_purchase_order_tba    
      template-code: "CREAZIONE_PO_DA_APPROVARE"  
      consumer-group: "notifier-group"  
      auto-ack: true
      
    # Purchase Order Approved
    - stream: "purchase-orders-stream"
      event-type: events:purchase_order_approved       
      template-code: "PO_APPROVATO_NOTIFICA_CREATORE" 
      consumer-group: "notifier-group"  
      auto-ack: true
      single-mail: true                           # Utilizza il template ma non la lista distribuzione (invio email singolo)  

    # Attachment Sharing Event
    - stream: "events-stream"
      event-type: attachment:share                
      template-code: "CONDIVISIONE_FILE"          
      consumer-group: "notifier-group"  
      auto-ack: true      
      single-mail: true                           # Utilizza il template ma non la lista distribuzione (invio email singolo)
      
    # Danni Semirimorchi
    - stream: "trailer-damage-stream"
      event-type: trailer:damage_report      
      template-code: "DANNI_TFP_TRAILER"           
      consumer-group: "notifier-group"  
      auto-ack: true

    # Richiesta HR DA APPROVARE
    - stream: "hr-requests-stream"
      event-type: events:new_hr_request_tba        
      template-code: "RICHIESTA_HR_DA_APPROVARE"  
      consumer-group: "notifier-group"  
      auto-ack: true
    
    # Richiesta HR APPROVATA
    - stream: "hr-requests-stream"
      event-type: events:new_hr_request_handling_result        
      template-code: "ESITO_APPROVAZIONE_RICHIESTA_HR"  
      consumer-group: "notifier-group"  
      auto-ack: true      
      single-mail: true                           # Utilizza il template ma non la lista distribuzione (invio email singolo)
            
    # Richiesta HR APPROVATA
    - stream: "hr-requests-stream"
      event-type: events:new_hr_request_ok_no_ts        
      template-code: "RICHIESTA_HR_OK_NO_TIMESHEET"  
      consumer-group: "notifier-group"  
      auto-ack: true      
      single-mail: true                           # Utilizza il template ma non la lista distribuzione (invio email singolo)            

    # Richiesta SCADENZA_PASSATA
    - stream: "deadlines-stream"
      event-type: deadline:overdue        
      template-code: "SCADENZE_EXPIRED"            
      consumer-group: "notifier-group"  
      auto-ack: true
      
    # Richiesta SCADENZE_AVVICINAMENTO
    - stream: "deadlines-stream"
      event-type: deadline:approaching        
      template-code: "SCADENZE_AVVICINAMENTO"         
      consumer-group: "notifier-group"  
      auto-ack: true

    # Richiesta RICHIESTA_PRENOTAZIONE
    - stream: "deadlines-stream"
      event-type: deadline:reservation_request        
      template-code: "RICHIESTA_PRENOTAZIONE"         
      consumer-group: "notifier-group"  
      auto-ack: true
      email-list-specified: true                           # la lista da usare e' specificata nell'evento
      email-sender-name: "Bernardini - Richiesta Prenotazione"